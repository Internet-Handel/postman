



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
        <link rel="canonical" href="https://jajir.github.io/postman/architecture/">
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1, mkdocs-material-4.6.3">
    
    
      
        <title>Architektura - Postman</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.adb8469c.css">
      
      
    
    
      <script src="../assets/javascripts/modernizr.86422ebf.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#architektura" tabindex="0" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://jajir.github.io/postman/" title="Postman" aria-label="Postman" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Postman
            </span>
            <span class="md-header-nav__topic">
              
                Architektura
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://jajir.github.io/postman/" title="Postman" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Postman
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../analyza/" title="Analýza" class="md-nav__link">
      Analýza
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Usecases
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Usecases
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../uc-00/" title="UC-04 - UC-07" class="md-nav__link">
      UC-04 - UC-07
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../uc-10/" title="UC-10 - UC-13" class="md-nav__link">
      UC-10 - UC-13
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../uc-20/" title="UC-20 - UC-29" class="md-nav__link">
      UC-20 - UC-29
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../uc-30/" title="UC-31 - UC-36" class="md-nav__link">
      UC-31 - UC-36
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../uc-40/" title="UC-40 - UC-49" class="md-nav__link">
      UC-40 - UC-49
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../uc-50/" title="UC-50 - UC-65" class="md-nav__link">
      UC-50 - UC-65
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../states/" title="Stavy" class="md-nav__link">
      Stavy
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../templates/" title="Šablony" class="md-nav__link">
      Šablony
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../screens/" title="Obrazovky" class="md-nav__link">
      Obrazovky
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Architektura
      </label>
    
    <a href="./" title="Architektura" class="md-nav__link md-nav__link--active">
      Architektura
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#kod-baliku" class="md-nav__link">
    Kód balíku
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kod-interniho-stitku-baliku" class="md-nav__link">
    Kód interního štítku balíku
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#variabilni-symbol-a-cislo-objednavky" class="md-nav__link">
    Variabilní symbol a číslo objednávky
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cislo-danoveho-dokladu" class="md-nav__link">
    Číslo daňového dokladu
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#entita-zakaznika" class="md-nav__link">
    Entita zákazníka
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#entitni-model" class="md-nav__link">
    Entitní model
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#objednavka" class="md-nav__link">
    Objednávka
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#balik" class="md-nav__link">
    Balík
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stavy-baliku" class="md-nav__link">
    Stavy balíku
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#navrh-architektury-applikace" class="md-nav__link">
    Návrh architektury applikace
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#auditni-log" class="md-nav__link">
    Auditní log
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#poznamky" class="md-nav__link">
    Poznámky
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#zajimave-odkazy" class="md-nav__link">
    Zajímavé odkazy
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../implementation/" title="Implementace" class="md-nav__link">
      Implementace
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../meetings/" title="Schůzky" class="md-nav__link">
      Schůzky
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../notes/" title="Poznámky" class="md-nav__link">
      Poznámky
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../changelog/" title="Změny" class="md-nav__link">
      Změny
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../how-to-contribute/" title="Jak přispět" class="md-nav__link">
      Jak přispět
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#kod-baliku" class="md-nav__link">
    Kód balíku
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kod-interniho-stitku-baliku" class="md-nav__link">
    Kód interního štítku balíku
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#variabilni-symbol-a-cislo-objednavky" class="md-nav__link">
    Variabilní symbol a číslo objednávky
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cislo-danoveho-dokladu" class="md-nav__link">
    Číslo daňového dokladu
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#entita-zakaznika" class="md-nav__link">
    Entita zákazníka
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#entitni-model" class="md-nav__link">
    Entitní model
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#objednavka" class="md-nav__link">
    Objednávka
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#balik" class="md-nav__link">
    Balík
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stavy-baliku" class="md-nav__link">
    Stavy balíku
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#navrh-architektury-applikace" class="md-nav__link">
    Návrh architektury applikace
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#auditni-log" class="md-nav__link">
    Auditní log
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#poznamky" class="md-nav__link">
    Poznámky
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#zajimave-odkazy" class="md-nav__link">
    Zajímavé odkazy
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="architektura">Architektura</h1>
<p>Technický návrh systému. Nebude možné zde popsat všechny aspekty řešení. Jsou zde popsané jen některé části.</p>
<h2 id="kod-baliku">Kód balíku</h2>
<p>Kód balíku musí splňovat několik vlastností:</p>
<ul>
<li>I po lidské chybě, jako je záměna dvou znaků, nebo překlep jednoho znaku musíme být schopní balíček dohledat.</li>
<li>Kód se musí pohodlně číst a opisovat.</li>
<li>Nebude rozlišovat velká a malá písmena.</li>
<li>Nesmí obsahovat znaky, v které se často zaměňují jako jsou:<ul>
<li>nula a <code>O</code>.</li>
<li>jedna a <code>L</code>.</li>
</ul>
</li>
</ul>
<p>Jedno z možných řešení je, že se kód kód bude skládat ze tří pomlčkou oddělených částí po čtyřech znacích: <code>XXXX-XXXX-XXXX</code>. Jednotlivé znaky budem náhodně generovat z těchto skupin:</p>
<ul>
<li>Souhlásky - <code>b, c, d, f, g, h, j, k, m, n, p, r, s, t, v, x, z</code></li>
<li>Samohlásky a číslice - <code>a, e, y, u, 2, 3, 4, 5, 6, 7, 8, 9</code></li>
</ul>
<p>Každá čtveřice bude vygenerovaná tak, že se budou střídat náhodné znaky z obou skupin. Střídat můžem i pořadí skupin. Například:</p>
<ul>
<li><code>K3GE-DAM8-ERUS</code></li>
<li><code>AT3K-8P3D-B4M6</code></li>
</ul>
<p>Variant kódu balíku bude:</p>
<p><img alt="Variant kódu balíku" src="../diagrams/out/arch-03.png" title="Variant kódu balíku" /></p>
<p>Pro každý balík, bude tento kód balíku vygenerovaný a uložený. Když operátor zadá kód balíku, pomocí nějakého algoritmu pro zjištění podobnosti dvou řetězců a najdeme ten, který v nějaké toleranci odpovídá. Jako inspirace lze použít Levenshteinovu vzdálenost. Pro hledání balíků podle kódu lze využít <a href="https://lucene.apache.org/solr/">SOLR</a>, kde již je Levenshteinova vzdálenost implementovaná.</p>
<p>Kódů balíků by měl být unikátní. Pokud se při jeho generování stane, že se vygeneruje již existující, pak se zahodí a systém zkusí vygenerovat další, dokud se netrefí do nepoužitého kódu balíku.</p>
<h2 id="kod-interniho-stitku-baliku">Kód interního štítku balíku</h2>
<p><strong>TODO TECH - Jak dlouhý bude? Podle specifikace čárového kódu?</strong></p>
<p>Jedná se o náhodné XXX místné číslo. Toto číslo se přiděluje balíku při přijetí. Je bezvýznamové a  není spjato s objednávkou nebo zákazníkem. Není spjato, protože při přijetí balíku se nemusí podařit dohledat ani objednávka ani zákazník. Kód na interním štítku balíku bude vytištěn jako čárový kód i jako čísla.</p>
<p>Kód interního štítku balíku bude náhodné číslo. Náhodné, abychom je mohli dobře odlišit. Je možné, že budem implementovat hledání podle poškozené části. V aktuálním něvrhu to není.</p>
<h2 id="variabilni-symbol-a-cislo-objednavky">Variabilní symbol a číslo objednávky</h2>
<p>Variabilní symbol pro zaplacení objednávky a číslo objednávky budou jedna hodnota. Bude to unikátní desetimístné náhodně vygenerované číslo. To, že je to desetimístné číslo plyne z formátu variabilního symbolu.</p>
<h2 id="cislo-danoveho-dokladu">Číslo daňového dokladu</h2>
<p>Daňové doklady jako jsou faktury a dobropisy musí být rozlišitelné podle jejich čísla. Pro všechny daňové doklady použijem 13 místné číslo složene z čísla objednávky doplněné pořadovým číslem daňového dokladu v objednávce. Například pro objednávku č.: <code>9812563321</code> bude mít faktura č.: <code>9812563321001</code>.</p>
<h2 id="entita-zakaznika">Entita zákazníka</h2>
<p>V některých případech by bylo dobré mít samostatnou entitu zákazníka a k ní napojené objednávky. Například bychom mohli lépe určit zákazníka podle čísla účtu příchozí platby. Toto teď nebudem implementovat.</p>
<h2 id="entitni-model">Entitní model</h2>
<p>Zde budou popsány vztajy mezi objekty a základní set attributů.</p>
<p>Vztahy mezi základními objekty budou vypadat takto:
<img alt="Přehled" src="../diagrams/out/arch-01.png" title="Přehled" /></p>
<h3 id="objednavka">Objednávka</h3>
<h3 id="balik">Balík</h3>
<p>U balíku se uchovává:</p>
<ul>
<li>Stav balíku - ze stavů je možné vyčíst, co se dějě a řídit, co se má stát.</li>
<li>Událost - jednorázová událost, která nemění stav balku. Například měření a vážení.</li>
</ul>
<p><img alt="Události balíku" src="../diagrams/out/arch-02.png" title="Události balíku" /></p>
<h4 id="stavy-baliku">Stavy balíku</h4>
<p>U balíku je třeba evidovat několik různých stavů. Jednotlivé stavy se od sebe mohou lišit počtem atributů a způsobem práce s nimi. Například stav "Poškozený balík" může být přiřazen na dispečera nebo pracovníka podpory. Ostatní stavy jsou vždy přiřazeny na jednu roli. Například pokud je balík ve frontě, kde čeka na zaplacení, tak pouze pracovník podpory může říct, že je balík zaplacen a přesunout ho do fronty konkrétního doporavce.</p>
<p><img alt="Stavy balíků" src="../diagrams/out/states-package-2.png" title="Stavy balíků" /></p>
<h2 id="navrh-architektury-applikace">Návrh architektury applikace</h2>
<p>Z počátku nepotřebujem nic speciálního. Pouze při realizací dávat pozor, že finální UC se mohou lišit od návrhů. Například implementace napojení na konkrétního dopravce může ovlivnost způsob zpracování fronty dopravce. Například požadavek na validaci adresy ze strany dopravce může vést k tomu, že při přijetí balíku a po jeho spárování s objednávkou se musí přidat validace adresy.</p>
<h2 id="auditni-log">Auditní log</h2>
<p>Systém nebude bezpečný. Bude možné vystavit fakturu zákazníkovy, změnit doručovací adaresu a podobné bez obvyklých kontrol. Z těchto důvodů budou změny ukládány do speciálního auditního logu. Log nebude systémem dále využíván. Pro kontrolu by nad ním měl být vybudovaný nějaký jednoduchý BI systém. Auditní log by měl být textový soubor, kde jednotlivé řádky budou představovat jednotlivé události. Událost se bude skládat z několika vhodně oddělenými poli v následujícím poředí:</p>
<ul>
<li>Datum a čas vzniku události.</li>
<li>Kdo událost vyvolal. Zde bude systém, nebo jméno konkrétního uživatele.</li>
<li>V jakém UC byla událost vyvolaná.</li>
<li>O jaký druh entity se jedná.</li>
<li>Identifikace měněné entity.</li>
<li>Popis změny. Například když pracovník změní doručovací adresu, pak by zde měla být nová adresa.</li>
<li>Jakékoliv další informace, které později můžou pomoct.</li>
</ul>
<p>Auditní log by se měl z bezpečnostních důvodů uládat jinam než provozní logy.</p>
<h2 id="poznamky">Poznámky</h2>
<p>Co by mělo platit:</p>
<ul>
<li>Při založení objednávky musí vzniknout instance balíku. Na ní je uložen kód balíku.</li>
<li>Balík, který se při přijetí nepodaří spojit s objednávkou, nemusí mít kód balíku.</li>
</ul>
<h2 id="zajimave-odkazy">Zajímavé odkazy</h2>
<p>Další informace jsou na:</p>
<ul>
<li>Wikipedia, Kontrolní číslo - <a href="https://en.wikipedia.org/wiki/Check_digit">https://en.wikipedia.org/wiki/Check_digit</a></li>
<li>Wikipedia, Levenshteinova vzdálenost - <a href="https://en.wikipedia.org/wiki/Levenshtein_distance">https://en.wikipedia.org/wiki/Levenshtein_distance</a></li>
<li>Wikipedia, Variabilní symbol - <a href="https://cs.wikipedia.org/wiki/Variabiln%C3%AD_symbol">https://cs.wikipedia.org/wiki/Variabilní_symbol</a></li>
<li>Wikipedia, Čárový kód - <a href="https://cs.wikipedia.org/wiki/Čárový_kód">https://cs.wikipedia.org/wiki/Čárový_kód</a></li>
</ul>
                
                  
                
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../screens/" title="Obrazovky" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Obrazovky
              </span>
            </div>
          </a>
        
        
          <a href="../implementation/" title="Implementace" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Implementace
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org" target="_blank" rel="noopener">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.c33a9706.js"></script>
      
      <script>app.initialize({version:"1.1",url:{base:".."}})</script>
      
    
  </body>
</html>